# TAP22 Architecture

## üèó –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

TAP22 –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º —Å—Ç–µ–∫–µ Next.js 14 —Å App Router, –∏—Å–ø–æ–ª—å–∑—É—è TypeScript –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –∏ Tailwind CSS –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
tap22/
‚îú‚îÄ‚îÄ app/                    # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ api/               # API endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/telegram/ # Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ chat/messages/ # –ß–∞—Ç API
‚îÇ   ‚îú‚îÄ‚îÄ chat/              # –°—Ç—Ä–∞–Ω–∏—Ü–∞ —á–∞—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ globals.css        # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx         # –ì–ª–∞–≤–Ω—ã–π layout
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx           # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îú‚îÄ‚îÄ components/            # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ chat/              # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —á–∞—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MessageInput.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ MessageItem.tsx
‚îÇ   ‚îú‚îÄ‚îÄ sidebar/           # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±–æ–∫–æ–≤–æ–≥–æ –º–µ–Ω—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ChatButton.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MenuButton.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TelegramWidget.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserProfile.tsx
‚îÇ   ‚îú‚îÄ‚îÄ ui/                # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserAvatar.tsx
‚îÇ   ‚îú‚îÄ‚îÄ Navbar.tsx         # –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ PageTransition.tsx # –ê–Ω–∏–º–∞—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.tsx        # –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é
‚îÇ   ‚îî‚îÄ‚îÄ StatusDisplay.tsx  # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
‚îú‚îÄ‚îÄ hooks/                 # Custom React hooks
‚îÇ   ‚îî‚îÄ‚îÄ useChat.ts         # –õ–æ–≥–∏–∫–∞ —á–∞—Ç–∞
‚îú‚îÄ‚îÄ lib/                   # –£—Ç–∏–ª–∏—Ç—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ navbar-context.tsx # –ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ supabase.ts        # Supabase –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ user-context.tsx   # –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ types/                 # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îî‚îÄ‚îÄ chat.ts            # –¢–∏–ø—ã —á–∞—Ç–∞
‚îî‚îÄ‚îÄ public/                # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
    ‚îú‚îÄ‚îÄ tap_logo_icon.jpg
    ‚îú‚îÄ‚îÄ tap_logo_small.jpg
    ‚îî‚îÄ‚îÄ tap_logo_website.jpg
```

## üîÑ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

### Context API
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç React Context –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è:

#### NavbarContext
```typescript
interface NavbarContextType {
  navbarState: 'home' | 'chat'
  setNavbarState: (state: 'home' | 'chat') => void
  isSidebarOpen: boolean
  setIsSidebarOpen: (open: boolean) => void
  isPageTransitioning: boolean
  setIsPageTransitioning: (transitioning: boolean) => void
  sidebarContentState: 'home' | 'chat'
  setSidebarContentState: (state: 'home' | 'chat') => void
}
```

#### UserContext
```typescript
interface UserContextType {
  user: User | null
  setUser: (user: User | null) => void
}
```

## üé® –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **–ê—Ç–æ–º–∞—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** - –±–∞–∑–æ–≤—ã–µ UI —ç–ª–µ–º–µ–Ω—Ç—ã (UserAvatar)
- **–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** - —Å–æ—Å—Ç–∞–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (MessageItem)
- **–û—Ä–≥–∞–Ω–∏–∑–º–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** - —Å–ª–æ–∂–Ω—ã–µ –±–ª–æ–∫–∏ (Navbar, Sidebar)
- **–®–∞–±–ª–æ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** - —Å—Ç—Ä–∞–Ω–∏—Ü—ã (page.tsx)

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ—à–∞–µ—Ç –æ–¥–Ω—É –∑–∞–¥–∞—á—É
- **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ—Å—Ç—å** - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ TypeScript
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

## üöÄ –ù–∞–≤–∏–≥–∞—Ü–∏—è –∏ —Ä–æ—É—Ç–∏–Ω–≥

### App Router (Next.js 14)
- **–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞** - —Ä–æ—É—Ç—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ø–∞–ø–æ–∫
- **Server Components** - —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **Client Components** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å 'use client'

### –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞
- **–ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** - —á–µ—Ä–µ–∑ router.push()
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–≤–±–∞—Ä–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å —Ä–æ—É—Ç–æ–º
- **–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã** - –ø–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏

## üé≠ –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∏–º–∞—Ü–∏–π

### PageTransition
–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π –ø–µ—Ä–µ—Ö–æ–¥–æ–≤:
```typescript
interface PageTransitionProps {
  children: React.ReactNode
}
```

### –ê–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞
1. **Fade-out** —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (300ms)
2. **–ü–µ—Ä–µ—Ö–æ–¥** –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. **Fade-in** –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (300ms)

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–π
- **Sidebar –∑–∞–∫—Ä—ã—Ç–∏–µ** - 500ms
- **Page transition** - 300ms
- **Navbar title** - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å transition

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### Telegram Widget
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–∏–¥–∂–µ—Ç** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Telegram –≤–∏–¥–∂–µ—Ç
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - —á–µ—Ä–µ–∑ Telegram Bot API
- **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –≤ localStorage

### Supabase Integration
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - PostgreSQL —á–µ—Ä–µ–∑ Supabase
- **Real-time** - –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - TypeScript —Ç–∏–ø—ã –¥–ª—è –¥–∞–Ω–Ω—ã—Ö

## üì± –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

### Mobile-First –ø–æ–¥—Ö–æ–¥
- **Breakpoints** - sm, md, lg, xl
- **Flexbox** - –æ—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏
- **Grid** - –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –º–∞–∫–µ—Ç–æ–≤

### –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **Navbar** - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã
- **Sidebar** - –ø–æ–ª–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
- **Chat** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ

## üéØ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **Code splitting** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–∞
- **Image optimization** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π Next.js
- **CSS optimization** - Tailwind CSS purging

### –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- **Dynamic imports** - –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **Suspense** - –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### TypeScript
- **–°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è** - –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã** - —á–µ—Ç–∫–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- **–£—Ç–∏–ª–∏—Ç—ã** - —Ç–∏–ø—ã –¥–ª—è Supabase –∏ API

### –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
- **Tailwind CSS** - utility-first –ø–æ–¥—Ö–æ–¥
- **CSS Variables** - –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤
- **Responsive design** - –º–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **TypeScript** - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤
- **ESLint** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞
- **Prettier** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

## üöÄ –î–µ–ø–ª–æ–π

### Production Build
```bash
npm run build
npm start
```

### Environment Variables
- **NEXT_PUBLIC_SUPABASE_URL** - URL Supabase –ø—Ä–æ–µ–∫—Ç–∞
- **NEXT_PUBLIC_SUPABASE_ANON_KEY** - –∞–Ω–æ–Ω–∏–º–Ω—ã–π –∫–ª—é—á Supabase
- **NEXT_PUBLIC_TELEGRAM_BOT_USERNAME** - –∏–º—è Telegram –±–æ—Ç–∞

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- **Minification** - –º–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è JS –∏ CSS
- **Tree shaking** - —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∫–æ–¥–∞
- **Compression** - —Å–∂–∞—Ç–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤